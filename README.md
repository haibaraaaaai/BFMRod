Test multiple threshold value for distance, make it CAP parameter?  GUI?
Whole file compare X_PCA[:, 0] and smooth_loop[phase[:],[0]].  GUI?
Speed from phase::

1. Most basic, simple convolution, typically up to 10.000 points. Will average the pauses with the speed ... 2. Change phi so that the speed does not depend on angle (non linearity correction). 3. Detect pauses . To do that I do non linear fitting of the phase, looking every where for the best "flat fit" rather than averaging all the speeds. It separates well traces alternating between pauses and high speeds. Tell me if you want to know more about it.

Test data

Issue with long files>>

Issue with timestamp

fix plotting then try again

feedback to martin? distance threshold and plotting and use traj instead of signal in cycle detection?